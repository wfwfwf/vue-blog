(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{818:function(e,r,a){"use strict";a.r(r);var o=a(5),n=Object(o.a)({},(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("使用nginx做反向代理的时候，可以简单的直接把请求原封不动的转发给下一个服务。设置proxy_pass请求只会替换域名，如果要根据不同的url后缀来访问不同的服务，则需要通过如下方法：")]),e._v(" "),a("p",[e._v('方法一：加"/"')]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('server {\n    listen              8000;\n    server_name         abc.com;\n    access_log  "pipe:rollback /data/log/nginx/access.log interval=1d baknum=7 maxsize=1G"  main;\n\n    location ^~/user/ {\n        proxy_set_header Host $host;\n        proxy_set_header  X-Real-IP        $remote_addr;\n        proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;\n        proxy_set_header X-NginX-Proxy true;\n\n        proxy_pass http://user/;\n    }\n\n    location ^~/order/ {\n        proxy_set_header Host $host;\n        proxy_set_header  X-Real-IP        $remote_addr;\n        proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;\n        proxy_set_header X-NginX-Proxy true;\n\n        proxy_pass http://order/;\n    }\n}\n')])])]),a("p",[e._v("^~/user/表示匹配前缀是user的请求，proxy_pass的结尾有/， 则会把/user/*后面的路径直接拼接到后面，即移除user。")]),e._v(" "),a("p",[e._v("方法二：rewrite")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('upstream user {\n  server localhost:8089 weight=5;\n}\nupstream order {\n  server localhost:8090 weight=5;\n}\n\nserver {\n    listen              80;\n    server_name  abc.com;\n    access_log  "pipe:rollback /data/log/nginx/access.log interval=1d baknum=7 maxsize=1G"  main;\n\n    location ^~/user/ {\n        proxy_set_header Host $host;\n        proxy_set_header  X-Real-IP        $remote_addr;\n        proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;\n        proxy_set_header X-NginX-Proxy true;\n\n        rewrite ^/user/(.*)$ /$1 break;\n        proxy_pass http://user;\n    }\n\n    location ^~/order/ {\n        proxy_set_header Host $host;\n        proxy_set_header  X-Real-IP        $remote_addr;\n        proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;\n        proxy_set_header X-NginX-Proxy true;\n\n        rewrite ^/order/(.*)$ /$1 break;\n        proxy_pass http://order;\n    }\n}\n')])])]),a("p",[e._v("proxy_pass结尾没有/， rewrite重写了url。")])])}),[],!1,null,null,null);r.default=n.exports}}]);